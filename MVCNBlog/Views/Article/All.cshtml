@model MVCNBlog.ViewModels.ListViewModel<MVCNBlog.ViewModels.ArticleViewModel>
@{
    ViewBag.Title = "All";
}
<div id="artcilesOutput">
    <div class="clearfix main_content floatleft">
        <div class="clearfix content">
            <div class="content_title">
                <h2>Latest Blog Post</h2>
            </div>
            @if (TempData["isFind"] != null)
            {
                @Html.Partial("Find", Model.ViewModels)
            }
            else
            {
                @Html.Partial("AllArticles", Model)
            }
        </div>
    </div>
    <div class="clearfix sidebar_container floatright">
        @if (!User.Identity.IsAuthenticated)
            {
            <div class="clearfix newsletter">
                @using (Html.BeginForm("Login", "Account", new { returnUrl = ViewBag.ReturnUrl }, FormMethod.Post,
                    new { @class = "form-horizontal", role = "form" }))
                {
                    @Html.AntiForgeryToken()
                    <h2>Signup for newsletter</h2>
                            @Html.TextBox("Email", null, new { id = "mce-EMAIL", type = "email", placeholder = "Email" })
                            @Html.TextBox("Password", null, new { id = "mce-TEXT", type = "password", placeholder = "Password" })
                            @Html.CheckBox("RememberMe")
                            <input type="submit" value="Submit" id="mc-embedded-subscribe" />
                }
            </div>
        }
        <div class="clearfix sidebar">
            @Html.Action("PopularSide")

            @Html.Action("RecentSide")
        </div>
    </div>

</div>


@section scripts
{
    <link rel="stylesheet" href="/Content/themes/base/jquery-ui.css">
    <script type="text/javascript">
        $(document).ready(function () {
            $(document).on('keyup', '#findArticle', (function (e) {
                var findInputVal = $("#findArticle").val();
                var url = '@Url.Action("Find", "Article")/' + findInputVal;

                $.ajax({
                    url: url,
                    cache: false,
                    type: "GET",
                    success: function (data) {

                        $('#allArticles').html(data);
                        window.history.pushState("finded articles", "", "/articles/find/" + findInputVal);

                    },
                    error: function (reponse) {
                    }
                });
            }));
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $(document).on('click', '.page', (function (e) {
                var newVal = $(e.target).attr("value");
                var url = '@Url.Action("All", "Article")/page' + newVal;

                $.ajax({
                    url: url,
                    cache: false,
                    type: "GET",
                    success: function (data) {

                        $('#artcilesOutput').replaceWith(data);
                        window.history.pushState("all articles", "", "/articles/page" + newVal);

                    },
                    error: function (reponse) {
                    }
                });
                e.preventDefault();
            }));
        });
    </script>
}


